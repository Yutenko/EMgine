<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Editor (Refactor Full)</title>
  <link rel="stylesheet" href="editor.css">
  <link rel="stylesheet" href="ui/ui-toolbar.css">
  <link rel="stylesheet" href="ui/ui-panel-layers.css">
  <link rel="stylesheet" href="ui/ui-canvas-input.css">
  <link rel="stylesheet" href="ui/ui-selection.css">
  <link rel="stylesheet" href="ui/ui-assets.css">
  <link rel="stylesheet" href="ui/ui-palette.css">

</head>

<body>
  <canvas id="canvas"></canvas>

  <!-- Core (engine) -->
  <script src="core/core-base.js"></script>
  <script src="core/core-world.js"></script>
  <script src="core/core-camera.js"></script>
  <script src="core/core-grid.js"></script>
  <script src="core/core-history.js"></script>
  <script src="core/core-levels.js"></script>
  <script src="core/core-chunks.js"></script>
  <script src="core/core-underlay.js"></script>
  <script src="core/core-render.js"></script>
  <script src="core/core-tilesetimport.js"></script>
  <script src="core/core-tiles-catalog.js"></script>
  <script src="core/core-tile-layer-mapping.js"></script>
  <script src="core/core-assetpool.js"></script>
  <script src="core/core-export.js"></script>



  <!-- UI -->
  <script src="ui/ui-panel-layers.js"></script>
  <script src="ui/ui-canvas-input.js"></script>
  <script src="ui/ui-rulers.js"></script>
  <script src="ui/ui-toolbar.js"></script>
  <script src="ui/ui-selection.js"></script>
  <script src="ui/ui-assets.js"></script>
  <script src="ui/ui-palette.js"></script>
  <script src="ui/ui-tile-selector.js"></script>


  <script>
    (function () {
      function boot() {
        var canvas = document.getElementById('canvas');
        if (!canvas) {console.error('[boot] no canvas'); return;}
        var editor = new Editor(canvas, {cols: 64, rows: 64, tileSize: 16, chunkTiles: 32});

        // Register core modules
        editor.use(EditorWorld);
        editor.use(EditorCamera);
        editor.use(EditorGrid);
        editor.use(EditorHistory);
        editor.use(EditorLevels);
        editor.use(EditorChunks);
        editor.use(EditorUnderlay);
        editor.use(EditorRender);
        editor.use(EditorTilesetImport);
        editor.use(EditorTilesCatalog)
        editor.use(EditorTileLayerMapping);
        editor.use(EditorAssetPool);
        editor.use(EditorExport);

        window.editor = editor;
        document.dispatchEvent(new CustomEvent('editor:ready', {detail: {editor: editor}}));
        console.log('[boot] editor ready');
      }
      if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', boot);
      else boot();
    })();
  </script>
</body>

</html>